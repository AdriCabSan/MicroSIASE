CREATE SCHEMA SiaseNxtGen;

CREATE TABLE StatusUser(
  Id TINYINT NOT NULL AUTO_INCREMENT,
  StatusDesc VARCHAR(30),
  PRIMARY KEY(Id)
);

CREATE TABLE TypeUser(
  Id TINYINT NOT NULL AUTO_INCREMENT,
  TypeUsrDesc VARCHAR(30),
  PRIMARY KEY (Id)
);

CREATE TABLE StatusUnit(
  Id TINYINT NOT NULL AUTO_INCREMENT,
  StatusUnitDesc VARCHAR(30),
  PRIMARY KEY (Id)
);

CREATE TABLE SystemUser(
  Id INT NOT NULL,
  Name VARCHAR(150),
  LastName VARCHAR(150),
  MotherLast VARCHAR(150),
  Passw VARCHAR(255),
  UsrType TINYINT NOT NULL,
  UsrStatus TINYINT NOT NULL,
  PRIMARY KEY (Id),
  FOREIGN KEY (UsrType) REFERENCES TypeUsr(Id),
  FOREIGN KEY (UsrStatus) REFERENCES StatusUsr(Id)
);

CREATE TABLE Topics(
  Id INT NOT NULL AUTO_INCREMENT,
  TopicName VARCHAR(150),
  IdTopicDependency INT DEFAULT 0,
  Semester INT NOT NULL,
  Description VARCHAR(255) DEFAULT 'No Description Provided',
  PRIMARY KEY (Id)
);

CREATE TABLE Groups(
  Id INT NOT NULL AUTO_INCREMENT,
  Room SMALLINT NOT NULL,
  IdTopic INT NOT NULL,
  IdTeacher INT NOT NULL,
  NMaxStudents SMALLINT NOT NULL,
  PRIMARY KEY (Id, Room),
  FOREIGN KEY (IdTeacher) REFERENCES SystemUser(Id)
);

CREATE TABLE GroupSchedules (
  Id INT NOT NULL,
  Room SMALLINT NOT NULL,
  HourStart TIME NOT NULL,
  HourEnd TIME NOT NULL,
  D1 TINYINT DEFAULT 0, solo es 1=,0=
  D2 TINYINT DEFAULT 0,
  D3 TINYINT DEFAULT 0,
  D4 TINYINT DEFAULT 0,
  D5 TINYINT DEFAULT 0,
  D6 TINYINT DEFAULT 0,
  PRIMARY KEY (Id, Room),
  FOREIGN KEY (Id) REFERENCES Groups(Id)
);

CREATE TABLE ListGrupo(
  IdGroup INT NOT NULL,
  IdStudent INT NOT NULL,
  PRIMARY KEY (IdGroup, IdStudent),
  FOREIGN KEY (idGroup) REFERENCES Groups(Id),
  FOREIGN KEY (IdStudent) REFERENCES SystemUser(Id)
);

CREATE TABLE StudentSchedule(
  IdStudent INT NOT NULL,
  Semester TINYINT NOT NULL,
  IdGroup INT NOT NULL,
  Grade TINYINT,
  Opportunity TINYINT DEFAULT 1,
  UnitStatus TINYINT DEFAULT 1,
  PRIMARY KEY (IdStudent),
  FOREIGN KEY (IdGroup) REFERENCES Groups(Id)
);